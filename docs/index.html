<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title></title>
  <link href="style.css" rel="stylesheet" />

</head>
<body>
  <h1 id="headline">Scan</h1>
  <video id="video-canvas" autoplay="true"></video>
  <script type="module">
    import ky from 'https://cdn.jsdelivr.net/npm/ky@latest/index.js';
    import QrScanner from './qr-scanner.min.js';

    const videoElement = document.getElementById('video-canvas');
    const headlineElement = document.getElementById('headline');
    var scans = 0;

    (async () => {
      const parsed = await ky('https://jsonplaceholder.typicode.com/todos/1').json();

      console.log(parsed.title);
      //=> 'delectus aut autem
    })();

    if (navigator.mediaDevices.getUserMedia) {
      navigator.mediaDevices.getUserMedia({video: true})
        .then(stream => {
          videoElement.srcObject = stream;
          const scanner = new QrScanner(videoElement, res => headline.textContent = `Scan #${scans++}: ${escape(res)}`);
          scanner.start();
        })
        .catch(err => console.log('stream-err: ', err));
    }
  </script>
</body>
</html>
